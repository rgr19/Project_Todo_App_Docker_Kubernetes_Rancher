dist: xenial
sudo: required
language: python
python: 3.7
install:
- pip install -r requirements.txt
services:
- docker
addons:
  apt:
    packages:
    - docker-ce
before_install:
- bash ./setup/fix/no_public_key_fix.sh
- bash ./setup/install/docker_install.sh
before_script:
- docker build ./todo-app/src/todo-view -f ./todo-app/src/todo-view/Dockerfile.dev
  -t todo-view-test
- docker build ./todo-app/src/todo-cache-service -f ./todo-app/src/common/Dockerfile.nodejs.dev
  -t todo-cache-service-test
script:
- docker run todo-view-test npm test -- --browsers=ChromeHeadlessNoSandbox --watch=false
  --no-progress
- docker run todo-cache-service-test npm test
after_success:
- python3.7 main.py DC BUILD
- echo "$DOCKER_HUB_PASSWORD" | docker login -u "$DOCKER_HUB_ID" --password-stdin
- python3.7 main.py DC PUSH
git:
  submodules: false
env:
  global:
    secure: tiDcVyM9rSjuQ2UHOD0HczIJmrxVmLFtpvU5TZ3tp9ePvh3bVJjakRuiyGXrzNhZJuq4wAimvzdY7xp5ZNa7qtP/0eb+kQ0GloZb1/UEs0YlPoNj0L8o3sgLdJ3EBPQ9BtZzeXtsmPTNvoMtMWKCn/rLn1OBKB7NvnpIJczbooM0wFJIIQB7/2gjacyKZw4aEI62QjxwvrDsKVqqgrfHC7g3NRW7H9o8QDyTrWK/scUbkc8xh0uuwM+Az2W3VgxNRX5jCrNAsbPWqFLPn0LHFCSY9fTdW2s4fqDuZGq1nydTwTJ50xC3m1X8vzuW8HpTUwJRszbPNKFTCtgwdrntUeBgq6kBaJq5GBuFwo+D9M+pFxGiXy5XdSAVGOMm1cANF1Uwiuahgtbx4DeOrbUIRTtN46KbtIH6hN+VJRkD9gviPiauCty7HRsypsE3FujQ1D5fD/Iw5CNPaRLhYTn1kAZpJymbDRUIfsa7b5BOuJ2UpiqPlawNfn0TLGDYmOHu0j5NahxisKMnTjywLalYhBuW5XYeJiRPljaVfr1k8KvNIDB54iz90FtVl06tRMghlrF2uBsABvWyLjliYvSadNFre72AfmO18KyjF1/mYslXsZ4As37JtTFtHLkQGUw+1oDBk9yyJZzavOfJ0Y5YYNdO+axWotEKKrMJEoe5xBM=
