dist: xenial
sudo: required
language: python
python: 3.7
install:
- pip install -r requirements.txt
services:
- docker
addons:
  apt:
    packages:
    - docker-ce
before_install:
- bash ./setup/fix/no_public_key_fix.sh
- bash ./setup/install/docker_install.sh
before_script:
- docker build ./todo-app/src/todo-view -f ./todo-app/src/todo-view/Dockerfile.dev
  -t todo-view-test
- docker build ./todo-app/src/todo-cache-service -f ./todo-app/src/common/Dockerfile.nodejs.dev
  -t todo-cache-service-test
script:
- docker run todo-view-test npm test -- --browsers=ChromeHeadlessNoSandbox --watch=false
  --no-progress
- docker run todo-cache-service-test npm test
after_success:
- python3.7 main.py DC BUILD
- echo "$DOCKER_HUB_PASSWORD" | docker login -u "$DOCKER_HUB_ID" --password-stdin
- python3.7 main.py DC PUSH
git:
  submodules: false
env:
  global:
    secure: mFT9sOu3nCtCNeOPBqk83bfmmAraIuH8nf2JDKUqoUZpCYNCumfWapHbzKMepiFhMHRTgfE7K0qAcsVZoL73xUOjYxNCYnUEa7LJ51AcLrcj5q8SeyGPfeTC6mYJnagYh71oDYb3Mxocrdaok/+d/WRPzDGx+MyVeX31nqoNEmw+ltDQqvDlSGwxF50vfCijHnycSTTCZIqReUS4GnoVmw7+j1CJPCCrbvWwiOY7EqqLUw8pmTkZQBi5aHBYSRsEjHXv8vOh5z96axTXYJQlxsVIXTW9pXDGRDenSqtb7ASw35gSD9XaJOCb8PZm867YADZ/7PMrDeuRxeAmuS+N1qJA8wfhrkToBMMEMWI36bHbmXQkmzDFxPtv5pV9wXHAVkqugUcSj8OD4R/2fenVkWr7McZ26esprNHShl7v/CMaSdPprdhKcA3VS0SqvT3q/nvSujW0mzySvcAnc/nlUrvj7immVSFZJkvHZFFXPw17Wa8QhEfYYxLxYAyHmmVQUmofRiSteYoF3/qYml+rDGy/d1gLtkcd59yVW/BH0P4Vha8lMc+F02Qh+Jl3JJ92GP5sB71XbMplyJb+UfpJWgQK/Y9c5XnWzkM0PXKFMR4vGvlXKKmN1OWpRTgKrI9d7ch5auRV7OF9YeKhw6ksrV/xdzAehvqQJy53soi5/CM=
