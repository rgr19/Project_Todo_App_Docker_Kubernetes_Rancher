dist: xenial
sudo: required
language: python
python: 3.7
install:
- pip install -r requirements.txt
services:
- docker
addons:
  apt:
    packages:
    - docker-ce
before_install:
- bash ./setup/fix/no_public_key_fix.sh
- bash ./setup/install/docker_install.sh
before_script:
- docker build ./todo-app/src/todo-view -f ./todo-app/src/todo-view/Dockerfile.dev
  -t todo-view-test
- docker build ./todo-app/src/todo-cache-service -f ./todo-app/src/common/Dockerfile.nodejs.dev
  -t todo-cache-service-test
script:
- docker run todo-view-test npm test -- --browsers=ChromeHeadlessNoSandbox --watch=false
  --no-progress
- docker run todo-cache-service-test npm test
after_success:
- python3.7 main.py DC BUILD
- echo "$DOCKER_HUB_PASSWORD" | docker login -u "$DOCKER_HUB_ID" --password-stdin
- python3.7 main.py DC PUSH
git:
  submodules: false
env:
  global:
    secure: ideJ4cEUZ2DRiHarUHawQxF6zVsLwOK0YzYlnaGyrs3GXBllECQT4gC+e9iPVW4hGAhywrx91J9PHWCePUy/6lG+eDo4fjvZ+ty6+avIKN7pyzT0rIn9PMKRfF6/KsvVq3Lnd3lYkpy3FDwyrk+Bg3pVZegr/6UE6ZCf8BPa9Zi5GwVJTbJOK25juLnXBmm24jpmyjum3vkHLecs6s6SVbdo+K2qfFwLqU2czps7iTil4Usrhriv6oW6+yKRkSm7MxjsiwkEDlQwmxzZY7rGA/N/4ui2fVJcJufeGJ5Np3fZwSmW6t+21NMRlzCL3JwAh6y94olptPdcXPrFdfNk/M37F8MxbJMdIwCrF9nZK+FaUn5jUHn/qUFw3UvjK6XRMBiEqGNcxlThb7QFOtuCVEd2HjrNlDetd6lhIxnIOexn4Rz22+u0tmo7uQjohOYeGAweYaNnjzo6qM5fq1+gVzdkG+fOTvETgbJdzDgX2dyCQ1etm8OqGOtDdGK24pfroYJ3xblXgvgsTuoG36OqV9TL+DaLdvnD/dus/MALjQzfYiLUXZ+H9FRvXrFr6JuldCZPiH+BHbeW5/dJjjQU7/z1m2+Yb1CMFFOaZ3FDebi0oBzwCGpxOFYdIZxfTSUqPucM+895c32EHv36H+bJ1rAdDTSQE5tnQfj032jP+MM=
