dist: xenial
sudo: required
language: python
python: 3.7
install:
- pip install -r requirements.txt
services:
- docker
addons:
  apt:
    packages:
    - docker-ce
before_install:
- bash ./setup/fix/no_public_key_fix.sh
- bash ./setup/install/docker_install.sh
before_script:
- docker build ./todo-app/src/todo-view -f ./todo-app/src/todo-view/Dockerfile.dev
  -t todo-view-test
- docker build ./todo-app/src/todo-cache-service -f ./todo-app/src/common/Dockerfile.nodejs.dev
  -t todo-cache-service-test
script:
- docker run todo-view-test npm test -- --browsers=ChromeHeadlessNoSandbox --watch=false
  --no-progress
- docker run todo-cache-service-test npm test
after_success:
- python3.7 main.py DC BUILD
- echo "$DOCKER_HUB_PASSWORD" | docker login -u "$DOCKER_HUB_ID" --password-stdin
- python3.7 main.py DC PUSH
git:
  submodules: false
env:
  global:
    secure: CcFECYUpyf3QC7KLsxzDrwFqT7NJMfKt3UTt67iUznjgA7t0OfDO0HIdDr1px2AwYzL8jsMZDvCT16el4gDRw10gjYlNKNrfVHl7Y/5vBMbC4q+KAMYL2UaJMlbvByIIyz/dpb/348pUnVXQiYNyeFP7SR3W796b5N85cNO5gcxoSgAu0AUNE+G0VdE5ZfTwcBSPRU/qq1W/8ldDcSv1SDxSMkplK+cUBlaNYfaMFodzSzvEwtiF8ld1Z3TbJatpVwVctTraHKOS9rC7aPb41BVq+lrHCJX9ZXFuPRc69GUz/wc45go/ClHhDq/jDD9cGIOcrD7VZLVFgBkq/hBp++h5MF9331PGTcqQleJWpnAgQc5r0Cg5KRX9zZTKfAwLCs/LHS2zrVR+lHSF1F3zVuuggN97btd+AiwspNzX9IkLpinZtM9+BQrn603cB9ItxJcBfmwWotuHVX6wDSVaIM0cqiXx2A/Plica59Kyo4jMkzWRecg0kfG5Jlj1wGYZ6uGqMxuws082YA+oRM73Slc0dHvz/HB6NhTSdbFqlOH39Tuzxwz+0EbgK7rDlbhRUC/jgUq3z/9Wzh7cua7MH073HFG3O/xJQayhTGzu3J/wxPQ79Y+nClElPM1D4lIJBf1rVuuiMrqHe9aavW2XoXYT9Od3iWRZ3ZjE1KIwVO0=
