dist: xenial
sudo: required
language: python
python: 3.7
install:
- pip install -r requirements.txt
services:
- docker
addons:
  apt:
    packages:
    - docker-ce
before_install:
- bash ./setup/fix/no_public_key_fix.sh
- bash ./setup/install/docker_install.sh
before_script:
- docker build ./todo-app/src/todo-view -f ./todo-app/src/todo-view/Dockerfile.dev
  -t todo-view-test
- docker build ./todo-app/src/todo-cache-service -f ./todo-app/src/common/Dockerfile.nodejs.dev
  -t todo-cache-service-test
script:
- docker run todo-view-test npm test -- --browsers=ChromeHeadlessNoSandbox --watch=false
  --no-progress
- docker run todo-cache-service-test npm test
after_success:
- python3.7 main.py DC BUILD
- echo "$DOCKER_HUB_PASSWORD" | docker login -u "$DOCKER_HUB_ID" --password-stdin
- python3.7 main.py DC PUSH
git:
  submodules: false
env:
  global:
    secure: sA7xw84DD6qihwiEBwnwgpGlgQWnpGuxSm6Y9Z82K8UKAb7kthJcX0YqM5dne0ZxDi8aqTdGovOw0AMCArKCwgHuF4G8c3Bgyw3w+YECYtLYpzJJg8fPSc4WDmIQE6VMg9N6gXX87jv+OqMPAktyssvp0uCGsGf8YOTQmtDIprmKsjPvElDcbkDvBMHXA7cFp7VDU6REp8/Fa4vf9FT128sUeRmc5vLjcuTqBGYjmq+RvACv49EWD7qz8RDEL0HdI9ek97SNEILMvY0z9DQE2TYQ/DGbMhHZ36TGuMAVh1rG25unMs/cmXZByWTg0xu8go3XDBKLYfHCR+/wUhljvGvpWdFcMLr+HrS26+UX+8sv/z+GX1WRfzGqiJB4nCrvStEc/Nhd+4cN2oFp5vAUm0o3XtJEwoOpW7xMgfLMhDopZMSmdQJA1qZXAwdj3Zrmh6PGh4z0/Est4fsKA9BL8DWnrzG204nfGas1xamosgMWXSUWOkeLW+0NJ2R/yEEt27Ii0hoAK0vPmkp1ZjotwdlLep7gqb5geP37JPyi9HQKixcse/8OJjLItqggja9kqTchvr/g5ouUIvi1TEpOZkJ12f6c6vaSipXYpjinABLTQLuRFU9AJCCDlPVlXjM//P42Ud6qkK0dtS4rN4hjPlbDXF120G6niTBFaqaYIH0=
